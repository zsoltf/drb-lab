#!/usr/bin/env ruby -w
lib = File.expand_path('../../lib', __FILE__)
$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)

require 'nag'
require 'awesome_print'

class Nag::Monitor < DRbNode
  def start
    loop do
      system("clear")
      s = services.map {|e| Hash[e[1], e[3]] }
      msg = read_all_data.group_by {|e| e[1] }
        .map {|k,v| Hash[k, v.last.last]}
      require 'pry';binding.pry
      sleep 1
    end
  end
end

Nag::Monitor.new.start
